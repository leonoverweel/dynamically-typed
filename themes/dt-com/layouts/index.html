{{ define "main" }}

<div class="index-header">
    <h1>Dynamically Typed</h1>
    <form>
        <input type="email" id="email" placeholder="Write your email..." />
        <input type="submit" value="Subscibe" />
    </form>
</div>

{{ $allIssues := where .Site.RegularPages ".Section" "in" "issues" }}
{{ $allStories := where .Site.RegularPages ".Section" "in" "stories" }}
{{ $allLinks := where .Site.RegularPages ".Section" "in" "quick-links" }}
{{ $categories := .Site.Data.categories }}

<p>Total issues: {{ len $allIssues }}</p>
<p>Total stories: {{ len $allStories }}</p>
<p>Total links: {{ len $allLinks }}</p>

<p>Recent issues: (<a href="/issues">see all</a>)</p>
<ul>
    {{ range first 5 $allIssues }}
    <li>
        {{  .Params.date.Format "Jan 2" }} -
        <a href="{{ .URL }}">{{ safeHTML .Title }}</a>
    </li>
    {{ end }}
</ul>

<p>Categories:</p>
<ul>
    {{ range sort .Site.Data.categories "index" }}
    <li>
        {{ .name }}
        {{ $content := where $.Site.Pages ".Params.category" .category }}
        (Stories: {{ len ($allStories | intersect $content) }};
        Links: {{ len ($content | complement $allStories) }})
    </li>
    {{ end }}
</ul>

{{ end }}