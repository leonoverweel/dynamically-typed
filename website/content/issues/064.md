---
title: "#64: Google&#x27;s tips for reducing the CO2 emissions of training AI models "
date: 2021-04-25
number: 64
aliases:
  - /issues/64-google-s-tips-for-reducing-the-co2-emissions-of-training-ai-models-555894
---

Hey everyone, welcome to Dynamically Typed #64 ‚Äî another base-2 milestone just over a year after I sent out [DT #32](https://dynamicallytyped.com/issues/032/?utm_campaign=Dynamically%20Typed&utm_medium=email&utm_source=Revue%20newsletter)!

Today‚Äôs DT started off as a regular links-centric issue, until I came across a blog post Google released three days ago (on Earth Day): [How we‚Äôre minimizing AI‚Äôs carbon footprint](https://blog.google/technology/ai/minimizing-carbon-footprint/?utm_campaign=Dynamically%20Typed&utm_medium=email&utm_source=Revue%20newsletter).
It‚Äôs the press release version of a fascinating 22-page paper on AI model training emissions measurement and reduction, which has enough interesting tidbits to write a whole edition of DT about ‚Äî so that‚Äôs what I did; the regular links will be back two weeks from now.

## Artificial Intelligence for the Climate Crisis üåç

David Patterson wrote a blog post for Google‚Äôs The Keyword blog on [how the company is minimizing AI‚Äôs carbon footprint](https://blog.google/technology/ai/minimizing-carbon-footprint/?utm_campaign=Dynamically%20Typed&utm_medium=email&utm_source=Revue%20newsletter), mostly covering his new paper on the topic: [Carbon Emissions and Large Neural Network Training](https://arxiv.org/abs/2104.10350?utm_campaign=Dynamically%20Typed&utm_medium=email&utm_source=Revue%20newsletter) (Patterson et al.
2021).
The paper went live on arXiv just half a week ago, but coming in at 22 data-dense pages, I think it‚Äôll become a key piece of literature for sustainable AI.
My two main takeaways from the paper were: (1) retroactively estimating AI training emissions is difficult, so researchers should measure it during model development; and (2) where, when and on what hardware models are trained can make an enormous difference in emissions.

**Emissions estimates**

Patterson et al.
calculate the carbon footprint of several recent gargantuan models ([T5](http://ai.googleblog.com/2020/02/exploring-transfer-learning-with-t5?utm_campaign=Dynamically%20Typed&utm_medium=email&utm_source=Revue%20newsletter), [Meena](https://ai.googleblog.com/2019/06/applying-automl-to-transformer.html?utm_campaign=Dynamically%20Typed&utm_medium=email&utm_source=Revue%20newsletter), [GPT-3](https://dynamicallytyped.com/stories/2020/gpt-3/?utm_campaign=Dynamically%20Typed&utm_medium=email&utm_source=Revue%20newsletter), etc.) more precisely than previous work, which they found to be off by up to two orders of magnitude in some cases: the previous estimate for [The Evolved Transformer](https://arxiv.org/abs/1901.11117?utm_campaign=Dynamically%20Typed&utm_medium=email&utm_source=Revue%20newsletter)‚Äòs Neural Architecture Search (NAS), for example, was 88 times too high (see Appendix D).
This shows that, without knowing the exact datacenter, hardware, search algorithm choices, etc., it‚Äôs pretty much impossible to accurately estimate how much CO2 was emitted while training a model.

Because of this, one of the authors‚Äô recommendations is for the machine learning community to include CO2 emissions estimates as a standard metric in papers: a measurement by the people training the models, who have much better access to all relevant information (see e.g.
Table 4 in the paper and the [Google Cloud page on their different datacenters‚Äô carbon intensities](https://cloud.google.com/sustainability/region-carbon?utm_campaign=Dynamically%20Typed&utm_medium=email&utm_source=Revue%20newsletter)), will always be more accurate than a retroactive estimate by another researcher.
If conferences and journals start requiring emissions metrics in paper submissions and include them in acceptance criteria, it‚Äôll encourage individual researchers and AI labs to take steps to reduce their emissions.

(As an aside, this is an interesting comparison that makes ‚Äútons of CO2-equivalent greenhouse gas emissions‚Äù a bit easier to think about: a whole passenger jet round trip flight between San Francisco and New York emits about 180 tons of CO2e; relative to that, ‚ÄúT5 training emissions are ~26%, Meena is 53%, Gshard-600B is ~2%, Switch Transformer is 32%, and GPT-3 is ~305% of such a round trip.‚Äù Puts it all in perspective quite well.)

**Emissions reductions**

Patterson et al.
also have some specific recommendations for reducing the CO2 emissions caused by training AI models:

> * Large but sparsely activated DNNs can consume <1/10th the energy of large, dense DNNs without sacrificing accuracy despite using as many or even more parameters.
> * Geographic location matters for ML workload scheduling since the fraction of carbon-free energy and resulting CO2e vary ~5X-10X, even within the same country and the same organization.
> * Specific datacenter infrastructure matters, as Cloud datacenters can be ~1.4-2X more energy efficient than typical datacenters, and the ML-oriented accelerators inside them can be ~2-5X more effective than off-the-shelf systems.

Adding all these up, ‚Äúremarkably, the choice of DNN, datacenter, and processor can reduce the carbon footprint up to ~100-1000X.‚Äù _Two to three orders of magnitude!_ Since this research happened inside Google, its teams are now already optimizing where and when large models are trained to take advantage of these ideas.
Another cool aspect of the paper is that each of the four specific focus points for reducing emissions (improvements in algorithms, processors, datacenters, and the grid‚Äôs energy mix) is accompanied by a business rationale for implementing it as a cloud provider ‚Äî I‚Äôm guessing the researchers also used some of these arguments to push for change internally at Google.
(Maybe, as a next step, they can also look into [ramping model training based on signals from the intraday electricity market](https://dynamicallytyped.com/stories/2021/gargantuan-ai-model-climate-opportunity/?utm_campaign=Dynamically%20Typed&utm_medium=email&utm_source=Revue%20newsletter)?)

It‚Äôs great to see a paper on AI sustainability with so much measured data and actionable advice.
I haven‚Äôt seen it going around much yet on Twitter, but I hope it‚Äôs read widely ‚Äî [here‚Äôs the PDF link again](https://arxiv.org/pdf/2104.10350.pdf?utm_campaign=Dynamically%20Typed&utm_medium=email&utm_source=Revue%20newsletter); the fallacy debunks in section 4.5 (page 12) are an interesting bit I haven‚Äôt summarized above, so give it a click!
I also hope that the paper‚Äôs recommendations are implemented: even just the relatively low-effort change of shifting our training workloads to different datacenters can already make a big difference.
And of course it‚Äôll be interesting to see if there are any specific critiques on the paper‚Äôs emissions measurement methodology, since of course this is all still just a preprint and half the paper‚Äôs authors work at Google.

**Thanks for reading!**
As usual, you can let me know what you thought of today‚Äôs issue using the buttons below or by replying to this email.
If you‚Äôre new here, check out the [Dynamically Typed archives](https://dynamicallytyped.com/?utm_campaign=Dynamically%20Typed&utm_medium=email&utm_source=Revue%20newsletter) or subscribe below to get a new issues in your inbox every second Sunday.

**If you enjoyed this issue of Dynamically Typed, why not forward it to a friend?**
It‚Äôs by far the best thing you can do to help me grow this newsletter.
ü•≥